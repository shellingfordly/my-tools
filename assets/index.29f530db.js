import{r as d,d as _e,t as Ie,c as P,u as je,O as Ae,y as me,g as M,o as f,h as D,w as I,Q as Ne,C as J,a as E,m as Z,B as j,T as ve,n as O,e as x,D as ee,i as v,f as oe,S as pe,b as le,E as ne,G as te,$ as ye,R as ze}from"./index.4b01108f.js";import{B as Le,g as Ve,i as Ce,j as V,w as be,n as ge,_ as Fe,x as ae,s as Ge,a as He}from"./index.cdfcc5d8.js";import{j as Ke,k as We,o as R,a as re,I as Ye,e as Re,f as Ue,h as Xe,i as Qe,u as qe,b as Je,l as Ze,M as xe,m as eo}from"./use-popup-manager.b89a1cc3.js";import{C as oo,b as lo,d as no,K as to}from"./index.147dbbd6.js";import{I as ao}from"./index.45f5c73b.js";import{o as so}from"./index.c6a20670.js";var Po=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};const io=e=>{const o=d(!1),l={overflow:"",width:"",boxSizing:""};return{setOverflowHidden:()=>{if(e.value){const n=e.value;if(!o.value&&n.style.overflow!=="hidden"){const i=Ke(n);(i>0||We(n))&&(l.overflow=n.style.overflow,l.width=n.style.width,l.boxSizing=n.style.boxSizing,n.style.overflow="hidden",n.style.width=`${n.offsetWidth-i}px`,n.style.boxSizing="border-box",o.value=!0)}}},resetOverflow:()=>{if(e.value&&o.value){const n=e.value;n.style.overflow=l.overflow,n.style.width=l.width,n.style.boxSizing=l.boxSizing,o.value=!1}}}},ro=({modalRef:e,wrapperRef:o,draggable:l,alignCenter:c})=>{const r=d(!1),n=d([0,0]),i=d([0,0]),p=d(),y=d([0,0]),t=d([0,0]),u=()=>{var s,B,S;if(o.value&&e.value){const{top:w,left:h}=o.value.getBoundingClientRect(),{clientWidth:F,clientHeight:G}=o.value,{top:A,left:H,width:N,height:z}=e.value.getBoundingClientRect(),T=c.value?0:(s=e.value)==null?void 0:s.offsetTop,C=H-h,K=A-w-T;(C!==((B=i.value)==null?void 0:B[0])||K!==((S=i.value)==null?void 0:S[1]))&&(i.value=[C,K]);const L=F>N?F-N:0,W=G>z?G-z-T:0;(L!==t.value[0]||W!==t.value[1])&&(t.value=[L,W]),T&&(y.value=[0,0-T])}},m=s=>{l.value&&(s.preventDefault(),r.value=!0,u(),n.value=[s.x,s.y],R(window,"mousemove",b),R(window,"mouseup",g),R(window,"contextmenu",g))},b=s=>{if(r.value){const B=s.x-n.value[0],S=s.y-n.value[1];let w=i.value[0]+B,h=i.value[1]+S;w<y.value[0]&&(w=y.value[0]),w>t.value[0]&&(w=t.value[0]),h<y.value[1]&&(h=y.value[1]),h>t.value[1]&&(h=t.value[1]),p.value=[w,h]}},g=()=>{r.value=!1,re(window,"mousemove",b),re(window,"mouseup",g)};return{position:p,handleMoveDown:m}};var uo=Object.defineProperty,we=Object.getOwnPropertySymbols,fo=Object.prototype.hasOwnProperty,co=Object.prototype.propertyIsEnumerable,he=(e,o,l)=>o in e?uo(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l,mo=(e,o)=>{for(var l in o||(o={}))fo.call(o,l)&&he(e,l,o[l]);if(we)for(var l of we(o))co.call(o,l)&&he(e,l,o[l]);return e},vo=_e({name:"Modal",components:{ClientOnly:oo,ArcoButton:Le,IconHover:Ye,IconClose:Re,IconInfoCircleFill:ao,IconCheckCircleFill:Ue,IconExclamationCircleFill:Xe,IconCloseCircleFill:Qe},inheritAttrs:!1,props:{visible:{type:Boolean,default:void 0},defaultVisible:{type:Boolean,default:!1},width:{type:[Number,String]},top:{type:[Number,String]},mask:{type:Boolean,default:!0},title:{type:String},titleAlign:{type:String,default:"center"},alignCenter:{type:Boolean,default:!0},unmountOnClose:Boolean,maskClosable:{type:Boolean,default:!0},hideCancel:{type:Boolean,default:!1},simple:{type:Boolean,default:e=>e.notice},closable:{type:Boolean,default:!0},okText:String,cancelText:String,okLoading:{type:Boolean,default:!1},okButtonProps:{type:Object},cancelButtonProps:{type:Object},footer:{type:Boolean,default:!0},renderToBody:{type:Boolean,default:!0},popupContainer:{type:[String,Object],default:"body"},maskStyle:{type:Object},modalClass:{type:[String,Array]},modalStyle:{type:Object},onBeforeOk:{type:Function},onBeforeCancel:{type:Function},escToClose:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},maskAnimationName:{type:String,default:e=>e.fullscreen?"fade-in-standard":"fade-modal"},modalAnimationName:{type:String,default:e=>e.fullscreen?"zoom-in":"zoom-modal"},bodyClass:{type:[String,Array]},bodyStyle:{type:[String,Object,Array]},messageType:{type:String},hideTitle:{type:Boolean,default:!1}},emits:{"update:visible":e=>!0,ok:e=>!0,cancel:e=>!0,open:()=>!0,close:()=>!0,beforeOpen:()=>!0,beforeClose:()=>!0},setup(e,{emit:o}){const{fullscreen:l,popupContainer:c,alignCenter:r}=Ie(e),n=Ve("modal"),{t:i}=lo(),p=d(),y=d(),t=d(e.defaultVisible),u=P(()=>{var a;return(a=e.visible)!=null?a:t.value}),m=d(!1),b=P(()=>e.okLoading||m.value),g=P(()=>e.draggable&&!e.fullscreen),{teleportContainer:s,containerRef:B}=no({popupContainer:c,visible:u}),S=d(u.value),w=P(()=>e.okText||i("modal.okText")),h=P(()=>e.cancelText||i("modal.cancelText")),{zIndex:F,isLastDialog:G}=qe("dialog",{visible:u});let A=!1;const H=a=>{e.escToClose&&a.key===to.ESC&&G()&&X(a)},N=()=>{e.escToClose&&!A&&(A=!0,R(document.documentElement,"keydown",H))},z=()=>{A=!1,re(document.documentElement,"keydown",H)};let T=0;const{position:C,handleMoveDown:K}=ro({wrapperRef:p,modalRef:y,draggable:g,alignCenter:r}),L=()=>{T++,m.value&&(m.value=!1),t.value=!1,o("update:visible",!1)},W=async a=>{const k=T,Y=await new Promise(async q=>{var de;if(V(e.onBeforeOk)){let $=e.onBeforeOk((ce=!0)=>q(ce));if((be($)||!ge($))&&(m.value=!0),be($))try{$=(de=await $)!=null?de:!0}catch{$=!1}ge($)&&q($)}else q(!0)});k===T&&(Y?(o("ok",a),L()):m.value&&(m.value=!1))},X=a=>{var k;let Y=!0;V(e.onBeforeCancel)&&(Y=(k=e.onBeforeCancel())!=null?k:!1),Y&&(o("cancel",a),L())},Q=d(!1),Se=a=>{a.target===p.value&&(Q.value=!0)},Te=a=>{e.mask&&e.maskClosable&&Q.value&&X(a)},$e=()=>{u.value&&(!Ze(p.value,document.activeElement)&&document.activeElement instanceof HTMLElement&&document.activeElement.blur(),o("open"))},Pe=()=>{u.value||(g.value&&(C.value=void 0),S.value=!1,fe(),o("close"))},{setOverflowHidden:ue,resetOverflow:fe}=io(B);je(()=>{B.value=Je(e.popupContainer),u.value&&(ue(),e.escToClose&&N())}),Ae(()=>{fe(),z()}),me(u,a=>{t.value!==a&&(t.value=a),a?(o("beforeOpen"),S.value=!0,Q.value=!1,ue(),N()):(o("beforeClose"),z())}),me(l,()=>{C.value&&(C.value=void 0)});const Me=P(()=>[`${n}-wrapper`,{[`${n}-wrapper-align-center`]:e.alignCenter&&!e.fullscreen,[`${n}-wrapper-moved`]:Boolean(C.value)}]),De=P(()=>[`${n}`,e.modalClass,{[`${n}-simple`]:e.simple,[`${n}-draggable`]:g.value,[`${n}-fullscreen`]:e.fullscreen}]),Ee=P(()=>{var a;const k=mo({},(a=e.modalStyle)!=null?a:{});return e.width&&!e.fullscreen&&(k.width=Ce(e.width)?`${e.width}px`:e.width),!e.alignCenter&&e.top&&(k.top=Ce(e.top)?`${e.top}px`:e.top),C.value&&(k.transform=`translate(${C.value[0]}px, ${C.value[1]}px)`),k});return{prefixCls:n,mounted:S,computedVisible:u,containerRef:B,wrapperRef:p,mergedModalStyle:Ee,okDisplayText:w,cancelDisplayText:h,zIndex:F,handleOk:W,handleCancel:X,handleMaskClick:Te,handleMaskMouseDown:Se,handleOpen:$e,handleClose:Pe,mergedOkLoading:b,modalRef:y,wrapperCls:Me,modalCls:De,teleportContainer:s,handleMoveDown:K}}});function po(e,o,l,c,r,n){const i=M("icon-info-circle-fill"),p=M("icon-check-circle-fill"),y=M("icon-exclamation-circle-fill"),t=M("icon-close-circle-fill"),u=M("icon-close"),m=M("icon-hover"),b=M("arco-button"),g=M("client-only");return f(),D(g,null,{default:I(()=>[(f(),D(Ne,{to:e.teleportContainer,disabled:!e.renderToBody},[!e.unmountOnClose||e.computedVisible||e.mounted?J((f(),E("div",Z({key:0,class:`${e.prefixCls}-container`,style:{zIndex:e.zIndex}},e.$attrs),[j(ve,{name:e.maskAnimationName,appear:""},{default:I(()=>[e.mask?J((f(),E("div",{key:0,ref:"maskRef",class:O(`${e.prefixCls}-mask`),style:x(e.maskStyle)},null,6)),[[ee,e.computedVisible]]):v("v-if",!0)]),_:1},8,["name"]),oe("div",{ref:"wrapperRef",class:O(e.wrapperCls),onClick:o[2]||(o[2]=pe((...s)=>e.handleMaskClick&&e.handleMaskClick(...s),["self"])),onMousedown:o[3]||(o[3]=pe((...s)=>e.handleMaskMouseDown&&e.handleMaskMouseDown(...s),["self"]))},[j(ve,{name:e.modalAnimationName,appear:"",onAfterEnter:e.handleOpen,onAfterLeave:e.handleClose},{default:I(()=>[J(oe("div",{ref:"modalRef",class:O(e.modalCls),style:x(e.mergedModalStyle)},[!e.hideTitle&&(e.$slots.title||e.title||e.closable)?(f(),E("div",{key:0,class:O(`${e.prefixCls}-header`),onMousedown:o[1]||(o[1]=(...s)=>e.handleMoveDown&&e.handleMoveDown(...s))},[e.$slots.title||e.title?(f(),E("div",{key:0,class:O([`${e.prefixCls}-title`,`${e.prefixCls}-title-align-${e.titleAlign}`])},[e.messageType?(f(),E("div",{key:0,class:O(`${e.prefixCls}-title-icon`)},[e.messageType==="info"?(f(),D(i,{key:0})):v("v-if",!0),e.messageType==="success"?(f(),D(p,{key:1})):v("v-if",!0),e.messageType==="warning"?(f(),D(y,{key:2})):v("v-if",!0),e.messageType==="error"?(f(),D(t,{key:3})):v("v-if",!0)],2)):v("v-if",!0),le(e.$slots,"title",{},()=>[ne(te(e.title),1)])],2)):v("v-if",!0),!e.simple&&e.closable?(f(),E("div",{key:1,tabindex:"-1",role:"button","aria-label":"Close",class:O(`${e.prefixCls}-close-btn`),onClick:o[0]||(o[0]=(...s)=>e.handleCancel&&e.handleCancel(...s))},[j(m,null,{default:I(()=>[j(u)]),_:1})],2)):v("v-if",!0)],34)):v("v-if",!0),oe("div",{class:O([`${e.prefixCls}-body`,e.bodyClass]),style:x(e.bodyStyle)},[le(e.$slots,"default")],6),e.footer?(f(),E("div",{key:1,class:O(`${e.prefixCls}-footer`)},[le(e.$slots,"footer",{},()=>[e.hideCancel?v("v-if",!0):(f(),D(b,Z({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:I(()=>[ne(te(e.cancelDisplayText),1)]),_:1},16,["onClick"])),j(b,Z({type:"primary"},e.okButtonProps,{loading:e.mergedOkLoading,onClick:e.handleOk}),{default:I(()=>[ne(te(e.okDisplayText),1)]),_:1},16,["loading","onClick"])])],2)):v("v-if",!0)],6),[[ee,e.computedVisible]])]),_:3},8,["name","onAfterEnter","onAfterLeave"])],34)],16)),[[ee,e.computedVisible||e.mounted]]):v("v-if",!0)],8,["to","disabled"]))]),_:3})}var U=Fe(vo,[["render",po]]),yo=Object.defineProperty,Co=Object.defineProperties,bo=Object.getOwnPropertyDescriptors,ke=Object.getOwnPropertySymbols,go=Object.prototype.hasOwnProperty,wo=Object.prototype.propertyIsEnumerable,Oe=(e,o,l)=>o in e?yo(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l,_=(e,o)=>{for(var l in o||(o={}))go.call(o,l)&&Oe(e,l,o[l]);if(ke)for(var l of ke(o))wo.call(o,l)&&Oe(e,l,o[l]);return e},ho=(e,o)=>Co(e,bo(o));const se=(e,o)=>{let l=eo("modal");const c=()=>{t.component&&(t.component.props.visible=!1),V(e.onOk)&&e.onOk()},r=()=>{t.component&&(t.component.props.visible=!1),V(e.onCancel)&&e.onCancel()},n=async()=>{await ze(),l&&(ye(null,l),document.body.removeChild(l)),l=null,V(e.onClose)&&e.onClose()},i=()=>{t.component&&(t.component.props.visible=!1)},p=u=>{t.component&&Object.entries(u).forEach(([m,b])=>{t.component.props[m]=b})},t=j(U,_(_(_({},{visible:!0,renderToBody:!1,unmountOnClose:!0,onOk:c,onCancel:r,onClose:n}),so(e,["content","title","footer","visible","unmountOnClose","onOk","onCancel","onClose"])),{footer:typeof e.footer=="boolean"?e.footer:void 0}),{default:ae(e.content),title:ae(e.title),footer:typeof e.footer!="boolean"?ae(e.footer):void 0});return(o!=null?o:Be._context)&&(t.appContext=o!=null?o:Be._context),ye(t,l),document.body.appendChild(l),{close:i,update:p}},ie=_({open:se,confirm:(e,o)=>{const l=_({simple:!0,messageType:"warning"},e);return se(l,o)}},xe.reduce((e,o)=>(e[o]=(l,c)=>{const r=_({simple:!0,hideCancel:!0,messageType:o},l);return se(r,c)},e),{})),Be=Object.assign(U,ho(_({},ie),{install:(e,o)=>{Ge(e,o);const l=He(o);e.component(l+U.name,U);const c={};for(const r of Object.keys(ie))c[r]=(n,i=e._context)=>ie[r](n,i);e.config.globalProperties.$modal=c},_context:null}));export{Be as M,Po as c};
